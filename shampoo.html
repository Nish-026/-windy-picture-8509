<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="shampoo.css">
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
</head>
<body>
    <div>
        <div id="product_first_row">
            <div id="search_box">
                <div class="input-box">

                    <input type="text" placeholder="Search" id="search_box_" onkeyup="sr()">

                    <span id="search_icon">
                        <i class="uil uil-search search-icon"></i>
                    </span>
                </div>
            </div>
            <div id="filter">
                <select id="Filter">
                    <option value="">Filter By Price</option>
                    <option value="Hundred">below Rs.100</option>
                    <option value="ThreeHundred">Rs.100-Rs.300</option>
                    <option value="Sixhundred">Rs.300-Rs.600</option>
                    <option value="Abovesixhundred">Above Rs.600</option>
                  </select>
            </div>
            <div id="sort">
                <select id="Sort">
                    <option value="">Sort</option>
                    <option value="Asc">Low-to-High</option>
                    <option value="Desc">High-to-Low</option>
                  </select>
            </div>
        </div>
        <div id="Product_container"></div>
    </div>
</body>
</html>
<script>


let search = document.getElementById("search_box_");
let filter= document.getElementById("Filter");
let ProductSort= document.getElementById("Sort");
let mainSection = document.getElementById("Product_container");
let shampooData=[];
window.addEventListener("load",()=>{

fetchAndRenderShampoo()
})

function fetchAndRenderShampoo(){
fetch("https://63c9038ec3e2021b2d4d8542.mockapi.io/products/")
.then((res)=> res.json())
.then((data)=>{
    console.log(data);
    shampooData=data;
    let shampooObj= data.map((shampoo)=>({

        id:shampoo.id,
        title: shampoo.description,
        imageURL: shampoo.image,
        cost: "Rs."+shampoo.price

    }));
    renderCardList(shampooObj)
})
}



function renderCardList(cardData){
    let cardList=`
    <div class="card-list">
    ${cardData.map((item) =>
        getCard(
            item.id,
            item.title,
            item.imageURL,
            item.cost
         )
        ).join("")}
        </div>
    `
    mainSection.innerHTML=cardList;
}

function getCard(id,title,imageURL,cost){
    let card=`
    <div class="card" data-id=${id}>
    <div class="card-image">
    <img src=${imageURL} alt="food>
    </div>
    <div class="card-body">
    <h3 class="card-item card-title">${title}</h3>
    <div class="card-item card-additional-info">${cost}</div>
    <button class="card_addtocart">Add To Cart</button>
    </div>
    </div>
    `;
    return card
}


// ---------------------SEARCH--------------------------


let search_button= document.getElementById("search_icon")
search_button.addEventListener("click",()=>{
    let dib=search.value
    fData=shampooData
    let searched= shampooData.filter((item)=>{
        if(dib==item.brand){
            return true
        }
    })
    if(searched==null){
      fetchAndRenderShampoo()
    }
    fData=searched;
    functionalitiesShampoo(searched)


})

function functionalitiesShampoo(data){

let shampoo_obj= data.map((shampoo)=>({

    id:shampoo.id,
    title:shampoo.description,
    imageURL: shampoo.image,
    cost: "Rs."+shampoo.price

}));
renderCardList(shampoo_obj)

}


//--------------------------FILTER---------------------


filter.addEventListener("change",()=>{
    let filtered=shampooData.filter((item)=>{
        if(filter.value=="Hundred"){
            if(item.price<=100){
                return true;
            }
        }else if(filter.value=="ThreeHundred"){
            if(item.price<=300 && item.price>100){
                return true;
            }
        }else if(filter.value=="Sixhundred"){
            if(item.price<=600 && item.price>300){
                return true;
            }
        }else if(filter.value=="Abovesixhundred"){
            if(item.price>600){
                return true;
            }
        }else{
            fetchAndRenderShampoo()
        }
    })
    functionalitiesShampoo(filtered)
})

        //-------------SORT------------------------

ProductSort.addEventListener("change",()=>{
    console.log(ProductSort.value)
    if(ProductSort.value=="Asc"){
        let Asorted= shampooData.sort((a,b)=>{
            return a.price-b.price
        })
        console.log(Asorted)
        functionalitiesShampoo(Asorted)
    }else if(ProductSort.value=="Desc"){
        let Dsorted= shampooData.sort((a,b)=>{
            return b.price-a.price
        })
        functionalitiesShampoo(Dsorted)
    }else{
        fetchAndRenderShampoo()
    }
})
</script>